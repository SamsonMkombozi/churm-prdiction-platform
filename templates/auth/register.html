{% extends 'base.html' %}

{% block title %}Register - Churn Prediction Platform{% endblock %}

{% block content %}
<div class="row justify-content-center mt-5">
    <div class="col-md-6">
        <div class="card shadow-lg">
            <div class="card-body p-5">
                <div class="text-center mb-4">
                    <i class="fas fa-user-plus fa-4x text-primary mb-3"></i>
                    <h3 class="fw-bold">Create Your Account</h3>
                    <p class="text-muted">Start predicting churn in minutes</p>
                </div>
                
                <form method="POST" action="{{ url_for('auth.register') }}" id="registerForm">
                    <!-- Company Information -->
                    <h5 class="mb-3 text-primary">
                        <i class="fas fa-building me-2"></i>Company Information
                    </h5>
                    
                    <div class="mb-3">
                        <label for="company_name" class="form-label">Company Name *</label>
                        <input type="text" 
                               class="form-control" 
                               id="company_name" 
                               name="company_name" 
                               placeholder="Habari Company"
                               required>
                        <small class="form-text text-muted">This will be your organization's name</small>
                    </div>
                    
                    <hr class="my-4">
                    
                    <!-- Personal Information -->
                    <h5 class="mb-3 text-primary">
                        <i class="fas fa-user me-2"></i>Your Information
                    </h5>
                    
                    <div class="mb-3">
                        <label for="full_name" class="form-label">Full Name *</label>
                        <input type="text" 
                               class="form-control" 
                               id="full_name" 
                               name="full_name" 
                               placeholder="John Doe"
                               required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="email" class="form-label">Email Address *</label>
                        <input type="email" 
                               class="form-control" 
                               id="email" 
                               name="email" 
                               placeholder="your@email.com"
                               required>
                        <small class="form-text text-muted">You'll use this to log in</small>
                    </div>
                    
                    <div class="mb-3">
                        <label for="phone" class="form-label">Phone Number (Optional)</label>
                        <input type="tel" 
                               class="form-control" 
                               id="phone" 
                               name="phone" 
                               placeholder="+254 712 345 678">
                    </div>
                    
                    <div class="mb-3">
                        <label for="password" class="form-label">Password *</label>
                        <input type="password" 
                               class="form-control" 
                               id="password" 
                               name="password" 
                               placeholder="At least 8 characters"
                               required 
                               minlength="8">
                        <div class="progress mt-2" style="height: 5px;">
                            <div class="progress-bar" id="passwordStrength" role="progressbar" style="width: 0%"></div>
                        </div>
                        <small class="form-text text-muted" id="passwordHelp">At least 8 characters</small>
                    </div>
                    
                    <div class="mb-4">
                        <label for="confirm_password" class="form-label">Confirm Password *</label>
                        <input type="password" 
                               class="form-control" 
                               id="confirm_password" 
                               name="confirm_password" 
                               placeholder="Re-enter password"
                               required>
                        <small class="form-text" id="passwordMatch"></small>
                    </div>
                    
                    <div class="mb-3 form-check">
                        <input type="checkbox" 
                               class="form-check-input" 
                               id="terms" 
                               required>
                        <label class="form-check-label" for="terms">
                            I agree to the <a href="#" class="text-decoration-none">Terms of Service</a> 
                            and <a href="#" class="text-decoration-none">Privacy Policy</a>
                        </label>
                    </div>
                    
                    <button type="submit" class="btn btn-primary w-100 btn-lg">
                        <i class="fas fa-user-plus me-2"></i>Create Account
                    </button>
                </form>
                
                <hr class="my-4">
                
                <div class="text-center">
                    <p class="mb-0">
                        Already have an account? 
                        <a href="{{ url_for('auth.login') }}" class="fw-bold text-decoration-none">
                            Sign in here
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Password strength indicator
document.getElementById('password').addEventListener('input', function() {
    const password = this.value;
    const strengthBar = document.getElementById('passwordStrength');
    const helpText = document.getElementById('passwordHelp');
    
    let strength = 0;
    
    if (password.length >= 8) strength += 25;
    if (password.length >= 12) strength += 25;
    if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength += 25;
    if (/\d/.test(password)) strength += 25;
    
    strengthBar.style.width = strength + '%';
    
    if (strength < 50) {
        strengthBar.className = 'progress-bar bg-danger';
        helpText.textContent = 'Weak password';
        helpText.className = 'form-text text-danger';
    } else if (strength < 75) {
        strengthBar.className = 'progress-bar bg-warning';
        helpText.textContent = 'Medium password';
        helpText.className = 'form-text text-warning';
    } else {
        strengthBar.className = 'progress-bar bg-success';
        helpText.textContent = 'Strong password';
        helpText.className = 'form-text text-success';
    }
});

// Password match indicator
document.getElementById('confirm_password').addEventListener('input', function() {
    const password = document.getElementById('password').value;
    const confirm = this.value;
    const matchText = document.getElementById('passwordMatch');
    
    if (confirm === '') {
        matchText.textContent = '';
        return;
    }
    
    if (password === confirm) {
        matchText.textContent = '✓ Passwords match';
        matchText.className = 'form-text text-success';
    } else {
        matchText.textContent = '✗ Passwords do not match';
        matchText.className = 'form-text text-danger';
    }
});

// Form validation
document.getElementById('registerForm').addEventListener('submit', function(e) {
    const password = document.getElementById('password').value;
    const confirm = document.getElementById('confirm_password').value;
    
    if (password !== confirm) {
        e.preventDefault();
        alert('Passwords do not match!');
        return false;
    }
    
    if (password.length < 8) {
        e.preventDefault();
        alert('Password must be at least 8 characters!');
        return false;
    }
});
</script>
{% endblock %}